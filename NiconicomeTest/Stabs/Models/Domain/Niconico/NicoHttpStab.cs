using System;
using System.Collections.Generic;
using System.Linq;
using System.Net;
using System.Net.Http;
using System.Text;
using System.Threading.Tasks;
using Niconicome.Models.Domain.Niconico;

namespace NiconicomeTest.Stabs.Models.Domain.Niconico.NicoHttpStabs
{
    class NicoHttpStab : INicoHttp
    {
        public NicoHttpStab(HttpContent getContent, HttpContent putContent)
        {
            this.GetContent = getContent;
            this.PutContent = putContent;
            this.NiconicoBaseUri = new Uri("https://nicovideo.jp");
            this.NiconicoLoginUri = new Uri("https://secure.nicovideo.jp/secure/login?site=niconico");
            this.NiconicoLogoutUri = new Uri("https://account.nicovideo.jp/logout");
        }

        public HttpContent GetContent { get; set; }

        public HttpContent PutContent { get; set; }

        public async Task<string> GetStringAsync(Uri uri)
        {
            return await this.GetContent.ReadAsStringAsync();
        }

        public Task<HttpResponseMessage> GetAsync(Uri uri)
        {
            var msg = new HttpResponseMessage
            {
                StatusCode = HttpStatusCode.OK,
                ReasonPhrase = "Generated by stab",
                Content = this.GetContent,
            };

            return Task.FromResult(msg);
        }

        public Task<HttpResponseMessage> PostAsync(Uri uri, HttpContent content)
        {

            var msg = new HttpResponseMessage
            {
                StatusCode = HttpStatusCode.OK,
                ReasonPhrase = "Generated by stab",
                Content = this.PutContent,
            };

            return Task.FromResult(msg);
        }

        public Task<HttpResponseMessage> OptionAsync(Uri uri)
        {

            var msg = new HttpResponseMessage
            {
                StatusCode = HttpStatusCode.OK,
                ReasonPhrase = "Generated by stab",
                Content = new StringContent("HTTP OPTION Method")
            };

            return Task.FromResult(msg);
        }

        public Uri NiconicoLoginUri { get; init; }

        public Uri NiconicoBaseUri { get; init; }

        public Uri NiconicoLogoutUri { get; init; }
    }
}
