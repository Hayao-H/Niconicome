// src/shared/AttemptResult.ts
var AttemptResultWidthDataImpl = class {
  constructor(isSucceeded, data, message) {
    this.IsSucceeded = isSucceeded;
    this.Data = data;
    this.Message = message;
  }
  static Succeeded(data) {
    return new AttemptResultWidthDataImpl(true, data, null);
  }
  static Fail(message) {
    return new AttemptResultWidthDataImpl(false, null, message);
  }
};

// src/shared/ElementHandler.ts
var ElementHandlerImpl = class {
  Get(query) {
    let result;
    try {
      result = document.querySelector(query);
    } catch (e) {
      return AttemptResultWidthDataImpl.Fail(`\u8981\u7D20\u3092\u53D6\u5F97\u3067\u304D\u307E\u305B\u3093\u3067\u3057\u305F\u3002(\u8A73\u7D30\uFF1A${e.message})`);
    }
    return result == null ? AttemptResultWidthDataImpl.Fail("\u6307\u5B9A\u3055\u308C\u305F\u8981\u7D20\u304C\u898B\u3064\u304B\u308A\u307E\u305B\u3093\u3002") : AttemptResultWidthDataImpl.Succeeded(result);
  }
  GetAll(query) {
    let result;
    try {
      result = document.querySelectorAll(query);
    } catch (e) {
      return AttemptResultWidthDataImpl.Fail(`\u8981\u7D20\u3092\u53D6\u5F97\u3067\u304D\u307E\u305B\u3093\u3067\u3057\u305F\u3002(\u8A73\u7D30\uFF1A${e.message})`);
    }
    return AttemptResultWidthDataImpl.Succeeded(result);
  }
};

// src/videoList/widthHandler/ElementIds.ts
var ElementIDs = class {
};
ElementIDs.PageContent = ".PageContent";
ElementIDs.VideoListHeader = "#VideoListHeader";
ElementIDs.Separator = ".Separator";

// src/videoList/widthHandler/widthHandler.ts
var WidthHandlerImpl = class {
  constructor(elementHandler) {
    this._isResizing = false;
    this._elmHandler = elementHandler;
    this._columnIDs = {
      "0": "CheckBoxColumn",
      "1": "ThumbnailColumn",
      "2": "TitleColumn",
      "3": "UploadedDateTimeColumn",
      "4": "IsDownloadedColumn",
      "5": "ViewCountColumn",
      "6": "CommentCountColumn",
      "7": "MylistCountColumn",
      "8": "LikeCountColumn",
      "9": "MessageColumn"
    };
    this._separatorIDs = {
      "0": "#CheckBoxColumnSeparator",
      "1": "#ThumbnailColumnSeparator",
      "2": "#TitleColumnSeparator",
      "3": "#UploadedDateTimeColumnSeparator",
      "4": "#IsDownloadedColumnSeparator",
      "5": "#ViewCountColumnSeparator",
      "6": "#CommentCountColumnSeparator",
      "7": "#MylistCountColumnSeparator",
      "8": "#LikeCountColumnSeparator"
    };
  }
  //#endregion
  Initialize() {
    const sepResult = this._elmHandler.GetAll(ElementIDs.Separator);
    if (!sepResult.IsSucceeded || sepResult.Data === null)
      return;
    sepResult.Data.forEach((elm) => {
      if (!(elm instanceof HTMLElement))
        return;
      const indexS = elm.dataset.index;
      if (indexS == void 0)
        return;
      elm.addEventListener("mousedown", (_) => this.OnMouseDown(indexS));
    });
    const pageResult = this._elmHandler.Get(ElementIDs.PageContent);
    if (!pageResult.IsSucceeded || pageResult.Data === null || !(pageResult.Data instanceof HTMLElement))
      return;
    pageResult.Data.addEventListener("mouseup", (_) => this.OnMouseUp());
    const headerResult = this._elmHandler.Get(ElementIDs.VideoListHeader);
    if (!headerResult.IsSucceeded || headerResult.Data === null || !(headerResult.Data instanceof HTMLElement))
      return;
    headerResult.Data.addEventListener("mousemove", (e) => this.OnMouseMove(e));
  }
  //#region private
  OnMouseDown(index) {
    this._isResizing = true;
    this._resizingIndex = index;
  }
  OnMouseUp() {
    this._isResizing = false;
    this._resizingIndex = null;
  }
  OnMouseMove(e) {
    if (!this._isResizing || this._resizingIndex === null)
      return;
    const nextIndex = Number(this._resizingIndex) + 1;
    const headerResult = this._elmHandler.Get(`#${this._columnIDs[this._resizingIndex]}`);
    const nextHeaderResult = this._elmHandler.Get(`#${this._columnIDs[`${nextIndex}`]}`);
    const headerWrapperResult = this._elmHandler.Get(ElementIDs.VideoListHeader);
    const columnResult = this._elmHandler.GetAll(`.${this._columnIDs[this._resizingIndex]}`);
    const nextColumnResult = this._elmHandler.GetAll(`.${this._columnIDs[`${nextIndex}`]}`);
    const sepResult = this._elmHandler.Get(this._separatorIDs[this._resizingIndex]);
    if (!headerResult.IsSucceeded || headerResult.Data === null || !columnResult.IsSucceeded || columnResult.Data === null || !sepResult.IsSucceeded || sepResult.Data === null || !headerWrapperResult.IsSucceeded || headerWrapperResult.Data === null || !nextHeaderResult.IsSucceeded || nextHeaderResult.Data === null || !nextColumnResult.IsSucceeded || nextColumnResult.Data === null)
      return;
    if (!(headerResult.Data instanceof HTMLElement))
      return;
    if (!(nextHeaderResult.Data instanceof HTMLElement))
      return;
    const headerRect = headerResult.Data.getBoundingClientRect();
    const headerWrapperRect = headerWrapperResult.Data.getBoundingClientRect();
    const width = e.clientX - headerRect.left;
    const deltaWidth = width - headerResult.Data.offsetWidth;
    const nextWidth = nextHeaderResult.Data.offsetWidth - deltaWidth;
    headerResult.Data.style.width = `${width}px`;
    nextHeaderResult.Data.style.width = `${nextWidth}px`;
    columnResult.Data.forEach((elm) => {
      if (!(elm instanceof HTMLElement))
        return;
      elm.style.width = `${width}px`;
    });
    nextColumnResult.Data.forEach((elm) => {
      if (!(elm instanceof HTMLElement))
        return;
      elm.style.width = `${nextWidth}px`;
    });
    if (!(headerWrapperResult.Data instanceof HTMLElement))
      return;
    if (!(sepResult.Data instanceof HTMLElement))
      return;
    const left = headerRect.left - headerWrapperRect.left + width - 10;
    sepResult.Data.style.left = `${left}px`;
  }
  //#endregion
};

// src/videoList/main.ts
function main() {
  console.log("Hello World!!");
  const elmHandler = new ElementHandlerImpl();
  const widthHandler = new WidthHandlerImpl(elmHandler);
  widthHandler.Initialize();
}
export {
  main
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiLi4vLi4vLi4vLi4vLi4vLi4vTmljb25pY29tZVdlYi9zcmMvc2hhcmVkL0F0dGVtcHRSZXN1bHQudHMiLCAiLi4vLi4vLi4vLi4vLi4vLi4vTmljb25pY29tZVdlYi9zcmMvc2hhcmVkL0VsZW1lbnRIYW5kbGVyLnRzIiwgIi4uLy4uLy4uLy4uLy4uLy4uL05pY29uaWNvbWVXZWIvc3JjL3ZpZGVvTGlzdC93aWR0aEhhbmRsZXIvRWxlbWVudElkcy50cyIsICIuLi8uLi8uLi8uLi8uLi8uLi9OaWNvbmljb21lV2ViL3NyYy92aWRlb0xpc3Qvd2lkdGhIYW5kbGVyL3dpZHRoSGFuZGxlci50cyIsICIuLi8uLi8uLi8uLi8uLi8uLi9OaWNvbmljb21lV2ViL3NyYy92aWRlb0xpc3QvbWFpbi50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiZXhwb3J0IGludGVyZmFjZSBBdHRlbXB0UmVzdWx0V2lkdGhEYXRhPFQ+IGV4dGVuZHMgQXR0ZW1wdFJlc3VsdCB7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogXHUzMEM3XHUzMEZDXHUzMEJGXHJcbiAgICAgKi9cclxuICAgIHJlYWRvbmx5IERhdGE6IFQgfCBudWxsO1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIEF0dGVtcHRSZXN1bHQge1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogXHU2MjEwXHU1MjlGXHUzMEQ1XHUzMEU5XHUzMEIwXHJcbiAgICAgKi9cclxuICAgIHJlYWRvbmx5IElzU3VjY2VlZGVkOiBib29sZWFuO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogXHUzMEUxXHUzMEMzXHUzMEJCXHUzMEZDXHUzMEI4XHJcbiAgICAgKi9cclxuICAgIHJlYWRvbmx5IE1lc3NhZ2U6IHN0cmluZyB8IG51bGw7XHJcbn1cclxuXHJcblxyXG5leHBvcnQgY2xhc3MgQXR0ZW1wdFJlc3VsdFdpZHRoRGF0YUltcGw8VD4gaW1wbGVtZW50cyBBdHRlbXB0UmVzdWx0V2lkdGhEYXRhPFQ+IHtcclxuXHJcbiAgICBjb25zdHJ1Y3Rvcihpc1N1Y2NlZWRlZDogYm9vbGVhbiwgZGF0YTogVCB8IG51bGwsIG1lc3NhZ2U6IHN0cmluZyB8IG51bGwpIHtcclxuICAgICAgICB0aGlzLklzU3VjY2VlZGVkID0gaXNTdWNjZWVkZWQ7XHJcbiAgICAgICAgdGhpcy5EYXRhID0gZGF0YTtcclxuICAgICAgICB0aGlzLk1lc3NhZ2UgPSBtZXNzYWdlO1xyXG4gICAgfVxyXG5cclxuICAgIHJlYWRvbmx5IElzU3VjY2VlZGVkOiBib29sZWFuO1xyXG5cclxuICAgIHJlYWRvbmx5IERhdGE6IFQgfCBudWxsO1xyXG5cclxuICAgIHJlYWRvbmx5IE1lc3NhZ2U6IHN0cmluZyB8IG51bGw7XHJcblxyXG4gICAgcHVibGljIHN0YXRpYyBTdWNjZWVkZWQ8VD4oZGF0YTogVCB8IG51bGwpOiBBdHRlbXB0UmVzdWx0V2lkdGhEYXRhPFQ+IHtcclxuICAgICAgICByZXR1cm4gbmV3IEF0dGVtcHRSZXN1bHRXaWR0aERhdGFJbXBsKHRydWUsIGRhdGEsIG51bGwpO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBzdGF0aWMgRmFpbDxUPihtZXNzYWdlOiBzdHJpbmcpOiBBdHRlbXB0UmVzdWx0V2lkdGhEYXRhPFQ+IHtcclxuICAgICAgICByZXR1cm4gbmV3IEF0dGVtcHRSZXN1bHRXaWR0aERhdGFJbXBsKGZhbHNlLCBudWxsLCBtZXNzYWdlKTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIEF0dGVtcHRSZXN1bHRJbXBsIGltcGxlbWVudHMgQXR0ZW1wdFJlc3VsdCB7XHJcblxyXG4gICAgY29uc3RydWN0b3IoaXNTdWNjZWVkZWQ6IGJvb2xlYW4sIG1lc3NhZ2U6IHN0cmluZyB8IG51bGwpIHtcclxuICAgICAgICB0aGlzLklzU3VjY2VlZGVkID0gaXNTdWNjZWVkZWQ7XHJcbiAgICAgICAgdGhpcy5NZXNzYWdlID0gbWVzc2FnZTtcclxuICAgIH1cclxuXHJcbiAgICByZWFkb25seSBJc1N1Y2NlZWRlZDogYm9vbGVhbjtcclxuXHJcbiAgICByZWFkb25seSBNZXNzYWdlOiBzdHJpbmcgfCBudWxsO1xyXG5cclxuICAgIHB1YmxpYyBzdGF0aWMgU3VjY2VlZGVkKCk6IEF0dGVtcHRSZXN1bHQge1xyXG4gICAgICAgIHJldHVybiBuZXcgQXR0ZW1wdFJlc3VsdEltcGwodHJ1ZSwgbnVsbCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHN0YXRpYyBGYWlsKG1lc3NhZ2U6IHN0cmluZyk6IEF0dGVtcHRSZXN1bHQge1xyXG4gICAgICAgIHJldHVybiBuZXcgQXR0ZW1wdFJlc3VsdEltcGwoZmFsc2UsIG1lc3NhZ2UpO1xyXG4gICAgfVxyXG59XHJcblxyXG4iLCAiaW1wb3J0IHsgQXR0ZW1wdFJlc3VsdFdpZHRoRGF0YSwgQXR0ZW1wdFJlc3VsdFdpZHRoRGF0YUltcGwgfSBmcm9tIFwiLi9BdHRlbXB0UmVzdWx0XCI7XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIEVsZW1lbnRIYW5kbGVyIHtcclxuXHJcbiAgICAvKipcclxuICAgICAqIFx1ODk4MVx1N0QyMFx1MzA5Mlx1NTNENlx1NUY5N1x1MzA1OVx1MzA4QlxyXG4gICAgICogQHBhcmFtIHF1ZXJ5IFx1MzBBRlx1MzBBOFx1MzBFQVxyXG4gICAgICovXHJcbiAgICBHZXQocXVlcnk6c3RyaW5nKTogQXR0ZW1wdFJlc3VsdFdpZHRoRGF0YTxFbGVtZW50PjtcclxuXHJcbiAgICAvKipcclxuICAgICAqIFx1ODkwN1x1NjU3MFx1MzA2RVx1ODk4MVx1N0QyMFx1MzA5Mlx1NTNENlx1NUY5N1x1MzA1OVx1MzA4QlxyXG4gICAgICogQHBhcmFtIHF1ZXJ5IFx1MzBBRlx1MzBBOFx1MzBFQVxyXG4gICAgICovXHJcbiAgICBHZXRBbGwocXVlcnk6IHN0cmluZyk6IEF0dGVtcHRSZXN1bHRXaWR0aERhdGE8Tm9kZUxpc3RPZjxFbGVtZW50Pj47XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBFbGVtZW50SGFuZGxlckltcGwgaW1wbGVtZW50cyBFbGVtZW50SGFuZGxlciB7XHJcblxyXG4gICAgcHVibGljIEdldChxdWVyeTogc3RyaW5nKTogQXR0ZW1wdFJlc3VsdFdpZHRoRGF0YTxFbGVtZW50PiB7XHJcblxyXG4gICAgICAgIGxldCByZXN1bHQ6IEVsZW1lbnQgfCBudWxsO1xyXG5cclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICByZXN1bHQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHF1ZXJ5KTtcclxuICAgICAgICB9IGNhdGNoIChlOiBhbnkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIEF0dGVtcHRSZXN1bHRXaWR0aERhdGFJbXBsLkZhaWwoYFx1ODk4MVx1N0QyMFx1MzA5Mlx1NTNENlx1NUY5N1x1MzA2N1x1MzA0RFx1MzA3RVx1MzA1Qlx1MzA5M1x1MzA2N1x1MzA1N1x1MzA1Rlx1MzAwMihcdThBNzNcdTdEMzBcdUZGMUEke2UubWVzc2FnZX0pYCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gcmVzdWx0ID09IG51bGwgPyBBdHRlbXB0UmVzdWx0V2lkdGhEYXRhSW1wbC5GYWlsKFwiXHU2MzA3XHU1QjlBXHUzMDU1XHUzMDhDXHUzMDVGXHU4OTgxXHU3RDIwXHUzMDRDXHU4OThCXHUzMDY0XHUzMDRCXHUzMDhBXHUzMDdFXHUzMDVCXHUzMDkzXHUzMDAyXCIpIDogQXR0ZW1wdFJlc3VsdFdpZHRoRGF0YUltcGwuU3VjY2VlZGVkKHJlc3VsdCk7XHJcbiAgICB9XHJcblxyXG5cclxuICAgIHB1YmxpYyBHZXRBbGwocXVlcnk6IHN0cmluZyk6IEF0dGVtcHRSZXN1bHRXaWR0aERhdGE8Tm9kZUxpc3RPZjxFbGVtZW50Pj4ge1xyXG5cclxuICAgICAgICBsZXQgcmVzdWx0OiBOb2RlTGlzdE9mPEVsZW1lbnQ+O1xyXG5cclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICByZXN1bHQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHF1ZXJ5KTtcclxuICAgICAgICB9IGNhdGNoIChlOiBhbnkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIEF0dGVtcHRSZXN1bHRXaWR0aERhdGFJbXBsLkZhaWwoYFx1ODk4MVx1N0QyMFx1MzA5Mlx1NTNENlx1NUY5N1x1MzA2N1x1MzA0RFx1MzA3RVx1MzA1Qlx1MzA5M1x1MzA2N1x1MzA1N1x1MzA1Rlx1MzAwMihcdThBNzNcdTdEMzBcdUZGMUEke2UubWVzc2FnZX0pYCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gQXR0ZW1wdFJlc3VsdFdpZHRoRGF0YUltcGwuU3VjY2VlZGVkKHJlc3VsdCk7XHJcbiAgICB9XHJcblxyXG59IiwgImV4cG9ydCBjbGFzcyBFbGVtZW50SURzIHtcclxuXHJcbiAgICBwdWJsaWMgc3RhdGljIHJlYWRvbmx5IFBhZ2VDb250ZW50ID0gJy5QYWdlQ29udGVudCc7XHJcblxyXG4gICAgcHVibGljIHN0YXRpYyByZWFkb25seSBWaWRlb0xpc3RIZWFkZXIgPSAnI1ZpZGVvTGlzdEhlYWRlcic7XHJcblxyXG4gICAgcHVibGljIHN0YXRpYyByZWFkb25seSBTZXBhcmF0b3IgPSAnLlNlcGFyYXRvcic7XHJcblxyXG59IiwgImltcG9ydCB7IEF0dGVtcHRSZXN1bHRXaWR0aERhdGEgfSBmcm9tICcuLi8uLi9zaGFyZWQvQXR0ZW1wdFJlc3VsdCc7XHJcbmltcG9ydCB7IEVsZW1lbnRIYW5kbGVyIH0gZnJvbSAnLi4vLi4vc2hhcmVkL0VsZW1lbnRIYW5kbGVyJztcclxuaW1wb3J0IHsgRWxlbWVudElEcyB9IGZyb20gJy4vRWxlbWVudElkcyc7XHJcbmltcG9ydCB7IERpY3Rpb25hcnkgfSBmcm9tICcuLi8uLi9zaGFyZWQvQ29sbGVjdGlvbi9kaWN0aW9uYXJ5JztcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgV2lkdGhIYW5kbGVyIHtcclxuICAgIEluaXRpYWxpemUoKTogdm9pZDtcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIFdpZHRoSGFuZGxlckltcGwgaW1wbGVtZW50cyBXaWR0aEhhbmRsZXIge1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKGVsZW1lbnRIYW5kbGVyOiBFbGVtZW50SGFuZGxlcikge1xyXG4gICAgICAgIHRoaXMuX2VsbUhhbmRsZXIgPSBlbGVtZW50SGFuZGxlcjtcclxuICAgICAgICB0aGlzLl9jb2x1bW5JRHMgPSB7XHJcbiAgICAgICAgICAgICcwJzogJ0NoZWNrQm94Q29sdW1uJyxcclxuICAgICAgICAgICAgJzEnOiAnVGh1bWJuYWlsQ29sdW1uJyxcclxuICAgICAgICAgICAgJzInOiAnVGl0bGVDb2x1bW4nLFxyXG4gICAgICAgICAgICAnMyc6ICdVcGxvYWRlZERhdGVUaW1lQ29sdW1uJyxcclxuICAgICAgICAgICAgJzQnOiAnSXNEb3dubG9hZGVkQ29sdW1uJyxcclxuICAgICAgICAgICAgJzUnOiAnVmlld0NvdW50Q29sdW1uJyxcclxuICAgICAgICAgICAgJzYnOiAnQ29tbWVudENvdW50Q29sdW1uJyxcclxuICAgICAgICAgICAgJzcnOiAnTXlsaXN0Q291bnRDb2x1bW4nLFxyXG4gICAgICAgICAgICAnOCc6ICdMaWtlQ291bnRDb2x1bW4nLFxyXG4gICAgICAgICAgICAnOSc6ICdNZXNzYWdlQ29sdW1uJyxcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuX3NlcGFyYXRvcklEcyA9IHtcclxuICAgICAgICAgICAgJzAnOiAnI0NoZWNrQm94Q29sdW1uU2VwYXJhdG9yJyxcclxuICAgICAgICAgICAgJzEnOiAnI1RodW1ibmFpbENvbHVtblNlcGFyYXRvcicsXHJcbiAgICAgICAgICAgICcyJzogJyNUaXRsZUNvbHVtblNlcGFyYXRvcicsXHJcbiAgICAgICAgICAgICczJzogJyNVcGxvYWRlZERhdGVUaW1lQ29sdW1uU2VwYXJhdG9yJyxcclxuICAgICAgICAgICAgJzQnOiAnI0lzRG93bmxvYWRlZENvbHVtblNlcGFyYXRvcicsXHJcbiAgICAgICAgICAgICc1JzogJyNWaWV3Q291bnRDb2x1bW5TZXBhcmF0b3InLFxyXG4gICAgICAgICAgICAnNic6ICcjQ29tbWVudENvdW50Q29sdW1uU2VwYXJhdG9yJyxcclxuICAgICAgICAgICAgJzcnOiAnI015bGlzdENvdW50Q29sdW1uU2VwYXJhdG9yJyxcclxuICAgICAgICAgICAgJzgnOiAnI0xpa2VDb3VudENvbHVtblNlcGFyYXRvcicsXHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICAvLyNyZWdpb24gIGZpZWxkXHJcblxyXG4gICAgcHJpdmF0ZSByZWFkb25seSBfZWxtSGFuZGxlcjogRWxlbWVudEhhbmRsZXI7XHJcblxyXG4gICAgcHJpdmF0ZSByZWFkb25seSBfY29sdW1uSURzOiBEaWN0aW9uYXJ5PHN0cmluZz47XHJcblxyXG4gICAgcHJpdmF0ZSByZWFkb25seSBfc2VwYXJhdG9ySURzOiBEaWN0aW9uYXJ5PHN0cmluZz47XHJcblxyXG4gICAgcHJpdmF0ZSBfaXNSZXNpemluZyA9IGZhbHNlO1xyXG5cclxuICAgIHByaXZhdGUgX3Jlc2l6aW5nSW5kZXg6IG51bGwgfCBzdHJpbmc7XHJcblxyXG4gICAgLy8jZW5kcmVnaW9uXHJcblxyXG4gICAgcHVibGljIEluaXRpYWxpemUoKTogdm9pZCB7XHJcblxyXG4gICAgICAgIGNvbnN0IHNlcFJlc3VsdDogQXR0ZW1wdFJlc3VsdFdpZHRoRGF0YTxOb2RlTGlzdE9mPEVsZW1lbnQ+PiA9IHRoaXMuX2VsbUhhbmRsZXIuR2V0QWxsKEVsZW1lbnRJRHMuU2VwYXJhdG9yKTtcclxuICAgICAgICBpZiAoIXNlcFJlc3VsdC5Jc1N1Y2NlZWRlZCB8fCBzZXBSZXN1bHQuRGF0YSA9PT0gbnVsbCkgcmV0dXJuO1xyXG5cclxuICAgICAgICBzZXBSZXN1bHQuRGF0YS5mb3JFYWNoKGVsbSA9PiB7XHJcbiAgICAgICAgICAgIGlmICghKGVsbSBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KSkgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgaW5kZXhTID0gZWxtLmRhdGFzZXQuaW5kZXg7XHJcblxyXG4gICAgICAgICAgICBpZiAoaW5kZXhTID09IHVuZGVmaW5lZCkgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgZWxtLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIF8gPT4gdGhpcy5Pbk1vdXNlRG93bihpbmRleFMpKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgY29uc3QgcGFnZVJlc3VsdCA9IHRoaXMuX2VsbUhhbmRsZXIuR2V0KEVsZW1lbnRJRHMuUGFnZUNvbnRlbnQpO1xyXG4gICAgICAgIGlmICghcGFnZVJlc3VsdC5Jc1N1Y2NlZWRlZCB8fCBwYWdlUmVzdWx0LkRhdGEgPT09IG51bGwgfHwgIShwYWdlUmVzdWx0LkRhdGEgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCkpIHJldHVybjtcclxuICAgICAgICBwYWdlUmVzdWx0LkRhdGEuYWRkRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsIF8gPT4gdGhpcy5Pbk1vdXNlVXAoKSk7XHJcblxyXG4gICAgICAgIGNvbnN0IGhlYWRlclJlc3VsdCA9IHRoaXMuX2VsbUhhbmRsZXIuR2V0KEVsZW1lbnRJRHMuVmlkZW9MaXN0SGVhZGVyKTtcclxuICAgICAgICBpZiAoIWhlYWRlclJlc3VsdC5Jc1N1Y2NlZWRlZCB8fCBoZWFkZXJSZXN1bHQuRGF0YSA9PT0gbnVsbCB8fCAhKGhlYWRlclJlc3VsdC5EYXRhIGluc3RhbmNlb2YgSFRNTEVsZW1lbnQpKSByZXR1cm47XHJcbiAgICAgICAgaGVhZGVyUmVzdWx0LkRhdGEuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgZSA9PiB0aGlzLk9uTW91c2VNb3ZlKGUpKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgLy8jcmVnaW9uIHByaXZhdGVcclxuXHJcbiAgICBwcml2YXRlIE9uTW91c2VEb3duKGluZGV4OiBzdHJpbmcpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLl9pc1Jlc2l6aW5nID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLl9yZXNpemluZ0luZGV4ID0gaW5kZXg7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBPbk1vdXNlVXAoKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5faXNSZXNpemluZyA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuX3Jlc2l6aW5nSW5kZXggPSBudWxsO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgT25Nb3VzZU1vdmUoZTogTW91c2VFdmVudCk6IHZvaWQge1xyXG4gICAgICAgIGlmICghdGhpcy5faXNSZXNpemluZyB8fCB0aGlzLl9yZXNpemluZ0luZGV4ID09PSBudWxsKSByZXR1cm47XHJcblxyXG4gICAgICAgIGNvbnN0IG5leHRJbmRleCA9IE51bWJlcih0aGlzLl9yZXNpemluZ0luZGV4KSArIDE7XHJcblxyXG4gICAgICAgIGNvbnN0IGhlYWRlclJlc3VsdCA9IHRoaXMuX2VsbUhhbmRsZXIuR2V0KGAjJHt0aGlzLl9jb2x1bW5JRHNbdGhpcy5fcmVzaXppbmdJbmRleF19YCk7XHJcbiAgICAgICAgY29uc3QgbmV4dEhlYWRlclJlc3VsdCA9IHRoaXMuX2VsbUhhbmRsZXIuR2V0KGAjJHt0aGlzLl9jb2x1bW5JRHNbYCR7bmV4dEluZGV4fWBdfWApO1xyXG4gICAgICAgIGNvbnN0IGhlYWRlcldyYXBwZXJSZXN1bHQgPSB0aGlzLl9lbG1IYW5kbGVyLkdldChFbGVtZW50SURzLlZpZGVvTGlzdEhlYWRlcik7XHJcbiAgICAgICAgY29uc3QgY29sdW1uUmVzdWx0ID0gdGhpcy5fZWxtSGFuZGxlci5HZXRBbGwoYC4ke3RoaXMuX2NvbHVtbklEc1t0aGlzLl9yZXNpemluZ0luZGV4XX1gKTtcclxuICAgICAgICBjb25zdCBuZXh0Q29sdW1uUmVzdWx0ID0gdGhpcy5fZWxtSGFuZGxlci5HZXRBbGwoYC4ke3RoaXMuX2NvbHVtbklEc1tgJHtuZXh0SW5kZXh9YF19YCk7XHJcbiAgICAgICAgY29uc3Qgc2VwUmVzdWx0ID0gdGhpcy5fZWxtSGFuZGxlci5HZXQodGhpcy5fc2VwYXJhdG9ySURzW3RoaXMuX3Jlc2l6aW5nSW5kZXhdKTtcclxuXHJcbiAgICAgICAgaWYgKCFoZWFkZXJSZXN1bHQuSXNTdWNjZWVkZWQgfHwgaGVhZGVyUmVzdWx0LkRhdGEgPT09IG51bGwgfHwgIWNvbHVtblJlc3VsdC5Jc1N1Y2NlZWRlZCB8fCBjb2x1bW5SZXN1bHQuRGF0YSA9PT0gbnVsbCB8fCAhc2VwUmVzdWx0LklzU3VjY2VlZGVkIHx8IHNlcFJlc3VsdC5EYXRhID09PSBudWxsIHx8ICFoZWFkZXJXcmFwcGVyUmVzdWx0LklzU3VjY2VlZGVkIHx8IGhlYWRlcldyYXBwZXJSZXN1bHQuRGF0YSA9PT0gbnVsbCB8fCAhbmV4dEhlYWRlclJlc3VsdC5Jc1N1Y2NlZWRlZCB8fCBuZXh0SGVhZGVyUmVzdWx0LkRhdGEgPT09IG51bGwgfHwgIW5leHRDb2x1bW5SZXN1bHQuSXNTdWNjZWVkZWQgfHwgbmV4dENvbHVtblJlc3VsdC5EYXRhID09PSBudWxsKSByZXR1cm47XHJcblxyXG4gICAgICAgIGlmICghKGhlYWRlclJlc3VsdC5EYXRhIGluc3RhbmNlb2YgSFRNTEVsZW1lbnQpKSByZXR1cm47XHJcbiAgICAgICAgaWYgKCEobmV4dEhlYWRlclJlc3VsdC5EYXRhIGluc3RhbmNlb2YgSFRNTEVsZW1lbnQpKSByZXR1cm47XHJcblxyXG4gICAgICAgIGNvbnN0IGhlYWRlclJlY3Q6IERPTVJlY3QgPSBoZWFkZXJSZXN1bHQuRGF0YS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuICAgICAgICBjb25zdCBoZWFkZXJXcmFwcGVyUmVjdDogRE9NUmVjdCA9IGhlYWRlcldyYXBwZXJSZXN1bHQuRGF0YS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuXHJcblxyXG4gICAgICAgIGNvbnN0IHdpZHRoID0gZS5jbGllbnRYIC0gaGVhZGVyUmVjdC5sZWZ0O1xyXG4gICAgICAgIGNvbnN0IGRlbHRhV2lkdGggPSB3aWR0aCAtIGhlYWRlclJlc3VsdC5EYXRhLm9mZnNldFdpZHRoO1xyXG4gICAgICAgIGNvbnN0IG5leHRXaWR0aCA9IG5leHRIZWFkZXJSZXN1bHQuRGF0YS5vZmZzZXRXaWR0aCAtIGRlbHRhV2lkdGg7XHJcblxyXG4gICAgICAgIGhlYWRlclJlc3VsdC5EYXRhLnN0eWxlLndpZHRoID0gYCR7d2lkdGh9cHhgO1xyXG4gICAgICAgIG5leHRIZWFkZXJSZXN1bHQuRGF0YS5zdHlsZS53aWR0aCA9IGAke25leHRXaWR0aH1weGA7XHJcblxyXG4gICAgICAgIGNvbHVtblJlc3VsdC5EYXRhLmZvckVhY2goZWxtID0+IHtcclxuICAgICAgICAgICAgaWYgKCEoZWxtIGluc3RhbmNlb2YgSFRNTEVsZW1lbnQpKSByZXR1cm47XHJcblxyXG4gICAgICAgICAgICBlbG0uc3R5bGUud2lkdGggPSBgJHt3aWR0aH1weGA7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIG5leHRDb2x1bW5SZXN1bHQuRGF0YS5mb3JFYWNoKGVsbSA9PiB7XHJcbiAgICAgICAgICAgIGlmICghKGVsbSBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KSkgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgZWxtLnN0eWxlLndpZHRoID0gYCR7bmV4dFdpZHRofXB4YDtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaWYgKCEoaGVhZGVyV3JhcHBlclJlc3VsdC5EYXRhIGluc3RhbmNlb2YgSFRNTEVsZW1lbnQpKSByZXR1cm47XHJcbiAgICAgICAgaWYgKCEoc2VwUmVzdWx0LkRhdGEgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCkpIHJldHVybjtcclxuXHJcbiAgICAgICAgY29uc3QgbGVmdCA9IGhlYWRlclJlY3QubGVmdCAtIGhlYWRlcldyYXBwZXJSZWN0LmxlZnQgKyB3aWR0aCAtIDEwO1xyXG4gICAgICAgIHNlcFJlc3VsdC5EYXRhLnN0eWxlLmxlZnQgPSBgJHtsZWZ0fXB4YDtcclxuICAgIH1cclxuXHJcbiAgICAvLyNlbmRyZWdpb25cclxufVxyXG5cclxuaW50ZXJmYWNlIENsYXNzTmFtZXNEaWN0IHtcclxuICAgIFtpbmRleDogbnVtYmVyXTogc3RyaW5nO1xyXG59IiwgImltcG9ydCB7IEVsZW1lbnRIYW5kbGVyLCBFbGVtZW50SGFuZGxlckltcGwgfSBmcm9tIFwiLi4vc2hhcmVkL0VsZW1lbnRIYW5kbGVyXCI7XHJcbmltcG9ydCB7IFdpZHRoSGFuZGxlciwgV2lkdGhIYW5kbGVySW1wbCB9IGZyb20gXCIuL3dpZHRoSGFuZGxlci93aWR0aEhhbmRsZXJcIjtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBtYWluKCkge1xyXG4gICAgY29uc29sZS5sb2coXCJIZWxsbyBXb3JsZCEhXCIpO1xyXG5cclxuICAgIGNvbnN0IGVsbUhhbmRsZXI6IEVsZW1lbnRIYW5kbGVyID0gbmV3IEVsZW1lbnRIYW5kbGVySW1wbCgpO1xyXG4gICAgY29uc3Qgd2lkdGhIYW5kbGVyOiBXaWR0aEhhbmRsZXIgPSBuZXcgV2lkdGhIYW5kbGVySW1wbChlbG1IYW5kbGVyKTtcclxuXHJcbiAgICB3aWR0aEhhbmRsZXIuSW5pdGlhbGl6ZSgpO1xyXG5cclxufSJdLAogICJtYXBwaW5ncyI6ICI7QUFzQk8sSUFBTSw2QkFBTixNQUF5RTtBQUFBLEVBRTVFLFlBQVksYUFBc0IsTUFBZ0IsU0FBd0I7QUFDdEUsU0FBSyxjQUFjO0FBQ25CLFNBQUssT0FBTztBQUNaLFNBQUssVUFBVTtBQUFBLEVBQ25CO0FBQUEsRUFRQSxPQUFjLFVBQWEsTUFBMkM7QUFDbEUsV0FBTyxJQUFJLDJCQUEyQixNQUFNLE1BQU0sSUFBSTtBQUFBLEVBQzFEO0FBQUEsRUFFQSxPQUFjLEtBQVEsU0FBNEM7QUFDOUQsV0FBTyxJQUFJLDJCQUEyQixPQUFPLE1BQU0sT0FBTztBQUFBLEVBQzlEO0FBQ0o7OztBQzFCTyxJQUFNLHFCQUFOLE1BQW1EO0FBQUEsRUFFL0MsSUFBSSxPQUFnRDtBQUV2RCxRQUFJO0FBRUosUUFBSTtBQUNBLGVBQVMsU0FBUyxjQUFjLEtBQUs7QUFBQSxJQUN6QyxTQUFTLEdBQVA7QUFDRSxhQUFPLDJCQUEyQixLQUFLLDBHQUFxQixFQUFFLFVBQVU7QUFBQSxJQUM1RTtBQUVBLFdBQU8sVUFBVSxPQUFPLDJC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TSxtQkFBbUIsS0FBSyxZQUFZLE9BQU8sSUFBSSxLQUFLLFdBQVcsR0FBRyxXQUFXLEdBQUc7QUFDdEYsVUFBTSxZQUFZLEtBQUssWUFBWSxJQUFJLEtBQUssY0FBYyxLQUFLLGNBQWMsQ0FBQztBQUU5RSxRQUFJLENBQUMsYUFBYSxlQUFlLGFBQWEsU0FBUyxRQUFRLENBQUMsYUFBYSxlQUFlLGFBQWEsU0FBUyxRQUFRLENBQUMsVUFBVSxlQUFlLFVBQVUsU0FBUyxRQUFRLENBQUMsb0JBQW9CLGVBQWUsb0JBQW9CLFNBQVMsUUFBUSxDQUFDLGlCQUFpQixlQUFlLGlCQUFpQixTQUFTLFFBQVEsQ0FBQyxpQkFBaUIsZUFBZSxpQkFBaUIsU0FBUztBQUFNO0FBRTVYLFFBQUksRUFBRSxhQUFhLGdCQUFnQjtBQUFjO0FBQ2pELFFBQUksRUFBRSxpQkFBaUIsZ0JBQWdCO0FBQWM7QUFFckQsVUFBTSxhQUFzQixhQUFhLEtBQUssc0JBQXNCO0FBQ3BFLFVBQU0sb0JBQTZCLG9CQUFvQixLQUFLLHNCQUFzQjtBQUdsRixVQUFNLFFBQVEsRUFBRSxVQUFVLFdBQVc7QUFDckMsVUFBTSxhQUFhLFFBQVEsYUFBYSxLQUFLO0FBQzdDLFVBQU0sWUFBWSxpQkFBaUIsS0FBSyxjQUFjO0FBRXRELGlCQUFhLEtBQUssTUFBTSxRQUFRLEdBQUc7QUFDbkMscUJBQWlCLEtBQUssTUFBTSxRQUFRLEdBQUc7QUFFdkMsaUJBQWEsS0FBSyxRQUFRLFNBQU87QUFDN0IsVUFBSSxFQUFFLGVBQWU7QUFBYztBQUVuQyxVQUFJLE1BQU0sUUFBUSxHQUFHO0FBQUEsSUFDekIsQ0FBQztBQUVELHFCQUFpQixLQUFLLFFBQVEsU0FBTztBQUNqQyxVQUFJLEVBQUUsZUFBZTtBQUFjO0FBRW5DLFVBQUksTUFBTSxRQUFRLEdBQUc7QUFBQSxJQUN6QixDQUFDO0FBRUQsUUFBSSxFQUFFLG9CQUFvQixnQkFBZ0I7QUFBYztBQUN4RCxRQUFJLEVBQUUsVUFBVSxnQkFBZ0I7QUFBYztBQUU5QyxVQUFNLE9BQU8sV0FBVyxPQUFPLGtCQUFrQixPQUFPLFFBQVE7QUFDaEUsY0FBVSxLQUFLLE1BQU0sT0FBTyxHQUFHO0FBQUEsRUFDbkM7QUFBQTtBQUdKOzs7QUN0SU8sU0FBUyxPQUFPO0FBQ25CLFVBQVEsSUFBSSxlQUFlO0FBRTNCLFFBQU0sYUFBNkIsSUFBSSxtQkFBbUI7QUFDMUQsUUFBTSxlQUE2QixJQUFJLGlCQUFpQixVQUFVO0FBRWxFLGVBQWEsV0FBVztBQUU1QjsiLAogICJuYW1lcyI6IFtdCn0K
