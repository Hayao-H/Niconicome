// src/shared/AttemptResult.ts
var AttemptResultWidthDataImpl = class {
  constructor(isSucceeded, data, message) {
    this.IsSucceeded = isSucceeded;
    this.Data = data;
    this.Message = message;
  }
  static Succeeded(data) {
    return new AttemptResultWidthDataImpl(true, data, null);
  }
  static Fail(message) {
    return new AttemptResultWidthDataImpl(false, null, message);
  }
};

// src/shared/ElementHandler.ts
var ElementHandlerImpl = class {
  Get(query) {
    let result;
    try {
      result = document.querySelector(query);
    } catch (e) {
      return AttemptResultWidthDataImpl.Fail(`\u8981\u7D20\u3092\u53D6\u5F97\u3067\u304D\u307E\u305B\u3093\u3067\u3057\u305F\u3002(\u8A73\u7D30\uFF1A${e.message})`);
    }
    return result == null ? AttemptResultWidthDataImpl.Fail("\u6307\u5B9A\u3055\u308C\u305F\u8981\u7D20\u304C\u898B\u3064\u304B\u308A\u307E\u305B\u3093\u3002") : AttemptResultWidthDataImpl.Succeeded(result);
  }
  GetAll(query) {
    let result;
    try {
      result = document.querySelectorAll(query);
    } catch (e) {
      return AttemptResultWidthDataImpl.Fail(`\u8981\u7D20\u3092\u53D6\u5F97\u3067\u304D\u307E\u305B\u3093\u3067\u3057\u305F\u3002(\u8A73\u7D30\uFF1A${e.message})`);
    }
    return AttemptResultWidthDataImpl.Succeeded(result);
  }
};

// src/videoList/widthHandler/ElementIds.ts
var ElementIDs = class {
};
ElementIDs.PageContent = ".PageContent";
ElementIDs.VideoListHeader = "#VideoListHeader";
ElementIDs.Separator = ".Separator";

// src/videoList/widthHandler/widthHandler.ts
var WidthHandlerImpl = class {
  constructor(elementHandler) {
    this._isResizing = false;
    this._elmHandler = elementHandler;
    this._columnIDs = {
      "0": "CheckBoxColumn",
      "1": "ThumbnailColumn",
      "2": "TitleColumn",
      "3": "UploadedDateTimeColumn",
      "4": "IsDownloadedColumn",
      "5": "ViewCountColumn",
      "6": "CommentCountColumn",
      "7": "MylistCountColumn"
    };
    this._separatorIDs = {
      "0": "#CheckBoxColumnSeparator",
      "1": "#ThumbnailColumnSeparator",
      "2": "#TitleColumnSeparator",
      "3": "#UploadedDateTimeColumnSeparator",
      "4": "#IsDownloadedColumnSeparator",
      "5": "#ViewCountColumnSeparator",
      "6": "#CommentCountColumnSeparator",
      "7": "#MylistCountColumnSeparator"
    };
  }
  //#endregion
  Initialize() {
    const sepResult = this._elmHandler.GetAll(ElementIDs.Separator);
    if (!sepResult.IsSucceeded || sepResult.Data === null)
      return;
    sepResult.Data.forEach((elm) => {
      if (!(elm instanceof HTMLElement))
        return;
      const indexS = elm.dataset.index;
      if (indexS == void 0)
        return;
      elm.addEventListener("mousedown", (_) => this.OnMouseDown(indexS));
    });
    const pageResult = this._elmHandler.Get(ElementIDs.PageContent);
    if (!pageResult.IsSucceeded || pageResult.Data === null || !(pageResult.Data instanceof HTMLElement))
      return;
    pageResult.Data.addEventListener("mouseup", (_) => this.OnMouseUp());
    const headerResult = this._elmHandler.Get(ElementIDs.VideoListHeader);
    if (!headerResult.IsSucceeded || headerResult.Data === null || !(headerResult.Data instanceof HTMLElement))
      return;
    headerResult.Data.addEventListener("mousemove", (e) => this.OnMouseMove(e));
  }
  //#region private
  OnMouseDown(index) {
    this._isResizing = true;
    this._resizingIndex = index;
  }
  OnMouseUp() {
    this._isResizing = false;
    this._resizingIndex = null;
  }
  OnMouseMove(e) {
    if (!this._isResizing || this._resizingIndex === null)
      return;
    const nextIndex = Number(this._resizingIndex) + 1;
    const headerResult = this._elmHandler.Get(`#${this._columnIDs[this._resizingIndex]}`);
    const nextHeaderResult = this._elmHandler.Get(`#${this._columnIDs[`${nextIndex}`]}`);
    const headerWrapperResult = this._elmHandler.Get(ElementIDs.VideoListHeader);
    const columnResult = this._elmHandler.GetAll(`.${this._columnIDs[this._resizingIndex]}`);
    const nextColumnResult = this._elmHandler.GetAll(`.${this._columnIDs[`${nextIndex}`]}`);
    const sepResult = this._elmHandler.Get(this._separatorIDs[this._resizingIndex]);
    if (!headerResult.IsSucceeded || headerResult.Data === null || !columnResult.IsSucceeded || columnResult.Data === null || !sepResult.IsSucceeded || sepResult.Data === null || !headerWrapperResult.IsSucceeded || headerWrapperResult.Data === null || !nextHeaderResult.IsSucceeded || nextHeaderResult.Data === null || !nextColumnResult.IsSucceeded || nextColumnResult.Data === null)
      return;
    if (!(headerResult.Data instanceof HTMLElement))
      return;
    if (!(nextHeaderResult.Data instanceof HTMLElement))
      return;
    const headerRect = headerResult.Data.getBoundingClientRect();
    const headerWrapperRect = headerWrapperResult.Data.getBoundingClientRect();
    const width = e.clientX - headerRect.left;
    const deltaWidth = width - headerResult.Data.offsetWidth;
    const nextWidth = nextHeaderResult.Data.offsetWidth - deltaWidth;
    headerResult.Data.style.width = `${width}px`;
    nextHeaderResult.Data.style.width = `${nextWidth}px`;
    columnResult.Data.forEach((elm) => {
      if (!(elm instanceof HTMLElement))
        return;
      elm.style.width = `${width}px`;
    });
    nextColumnResult.Data.forEach((elm) => {
      if (!(elm instanceof HTMLElement))
        return;
      elm.style.width = `${nextWidth}px`;
    });
    if (!(headerWrapperResult.Data instanceof HTMLElement))
      return;
    if (!(sepResult.Data instanceof HTMLElement))
      return;
    const left = headerRect.left - headerWrapperRect.left + width - 10;
    sepResult.Data.style.left = `${left}px`;
  }
  //#endregion
};

// src/videoList/main.ts
function main() {
  console.log("Hello World!!");
  const elmHandler = new ElementHandlerImpl();
  const widthHandler = new WidthHandlerImpl(elmHandler);
  widthHandler.Initialize();
}
export {
  main
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiLi4vLi4vLi4vLi4vLi4vLi4vTmljb25pY29tZVdlYi9zcmMvc2hhcmVkL0F0dGVtcHRSZXN1bHQudHMiLCAiLi4vLi4vLi4vLi4vLi4vLi4vTmljb25pY29tZVdlYi9zcmMvc2hhcmVkL0VsZW1lbnRIYW5kbGVyLnRzIiwgIi4uLy4uLy4uLy4uLy4uLy4uL05pY29uaWNvbWVXZWIvc3JjL3ZpZGVvTGlzdC93aWR0aEhhbmRsZXIvRWxlbWVudElkcy50cyIsICIuLi8uLi8uLi8uLi8uLi8uLi9OaWNvbmljb21lV2ViL3NyYy92aWRlb0xpc3Qvd2lkdGhIYW5kbGVyL3dpZHRoSGFuZGxlci50cyIsICIuLi8uLi8uLi8uLi8uLi8uLi9OaWNvbmljb21lV2ViL3NyYy92aWRlb0xpc3QvbWFpbi50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiZXhwb3J0IGludGVyZmFjZSBBdHRlbXB0UmVzdWx0V2lkdGhEYXRhPFQ+IGV4dGVuZHMgQXR0ZW1wdFJlc3VsdCB7XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogXHUzMEM3XHUzMEZDXHUzMEJGXHJcbiAgICAgKi9cclxuICAgIHJlYWRvbmx5IERhdGE6IFQgfCBudWxsO1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIEF0dGVtcHRSZXN1bHQge1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogXHU2MjEwXHU1MjlGXHUzMEQ1XHUzMEU5XHUzMEIwXHJcbiAgICAgKi9cclxuICAgIHJlYWRvbmx5IElzU3VjY2VlZGVkOiBib29sZWFuO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogXHUzMEUxXHUzMEMzXHUzMEJCXHUzMEZDXHUzMEI4XHJcbiAgICAgKi9cclxuICAgIHJlYWRvbmx5IE1lc3NhZ2U6IHN0cmluZyB8IG51bGw7XHJcbn1cclxuXHJcblxyXG5leHBvcnQgY2xhc3MgQXR0ZW1wdFJlc3VsdFdpZHRoRGF0YUltcGw8VD4gaW1wbGVtZW50cyBBdHRlbXB0UmVzdWx0V2lkdGhEYXRhPFQ+IHtcclxuXHJcbiAgICBjb25zdHJ1Y3Rvcihpc1N1Y2NlZWRlZDogYm9vbGVhbiwgZGF0YTogVCB8IG51bGwsIG1lc3NhZ2U6IHN0cmluZyB8IG51bGwpIHtcclxuICAgICAgICB0aGlzLklzU3VjY2VlZGVkID0gaXNTdWNjZWVkZWQ7XHJcbiAgICAgICAgdGhpcy5EYXRhID0gZGF0YTtcclxuICAgICAgICB0aGlzLk1lc3NhZ2UgPSBtZXNzYWdlO1xyXG4gICAgfVxyXG5cclxuICAgIHJlYWRvbmx5IElzU3VjY2VlZGVkOiBib29sZWFuO1xyXG5cclxuICAgIHJlYWRvbmx5IERhdGE6IFQgfCBudWxsO1xyXG5cclxuICAgIHJlYWRvbmx5IE1lc3NhZ2U6IHN0cmluZyB8IG51bGw7XHJcblxyXG4gICAgcHVibGljIHN0YXRpYyBTdWNjZWVkZWQ8VD4oZGF0YTogVCB8IG51bGwpOiBBdHRlbXB0UmVzdWx0V2lkdGhEYXRhPFQ+IHtcclxuICAgICAgICByZXR1cm4gbmV3IEF0dGVtcHRSZXN1bHRXaWR0aERhdGFJbXBsKHRydWUsIGRhdGEsIG51bGwpO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBzdGF0aWMgRmFpbDxUPihtZXNzYWdlOiBzdHJpbmcpOiBBdHRlbXB0UmVzdWx0V2lkdGhEYXRhPFQ+IHtcclxuICAgICAgICByZXR1cm4gbmV3IEF0dGVtcHRSZXN1bHRXaWR0aERhdGFJbXBsKGZhbHNlLCBudWxsLCBtZXNzYWdlKTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIEF0dGVtcHRSZXN1bHRJbXBsIGltcGxlbWVudHMgQXR0ZW1wdFJlc3VsdCB7XHJcblxyXG4gICAgY29uc3RydWN0b3IoaXNTdWNjZWVkZWQ6IGJvb2xlYW4sIG1lc3NhZ2U6IHN0cmluZyB8IG51bGwpIHtcclxuICAgICAgICB0aGlzLklzU3VjY2VlZGVkID0gaXNTdWNjZWVkZWQ7XHJcbiAgICAgICAgdGhpcy5NZXNzYWdlID0gbWVzc2FnZTtcclxuICAgIH1cclxuXHJcbiAgICByZWFkb25seSBJc1N1Y2NlZWRlZDogYm9vbGVhbjtcclxuXHJcbiAgICByZWFkb25seSBNZXNzYWdlOiBzdHJpbmcgfCBudWxsO1xyXG5cclxuICAgIHB1YmxpYyBzdGF0aWMgU3VjY2VlZGVkKCk6IEF0dGVtcHRSZXN1bHQge1xyXG4gICAgICAgIHJldHVybiBuZXcgQXR0ZW1wdFJlc3VsdEltcGwodHJ1ZSwgbnVsbCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHN0YXRpYyBGYWlsKG1lc3NhZ2U6IHN0cmluZyk6IEF0dGVtcHRSZXN1bHQge1xyXG4gICAgICAgIHJldHVybiBuZXcgQXR0ZW1wdFJlc3VsdEltcGwoZmFsc2UsIG1lc3NhZ2UpO1xyXG4gICAgfVxyXG59XHJcblxyXG4iLCAiaW1wb3J0IHsgQXR0ZW1wdFJlc3VsdFdpZHRoRGF0YSwgQXR0ZW1wdFJlc3VsdFdpZHRoRGF0YUltcGwgfSBmcm9tIFwiLi9BdHRlbXB0UmVzdWx0XCI7XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIEVsZW1lbnRIYW5kbGVyIHtcclxuXHJcbiAgICAvKipcclxuICAgICAqIFx1ODk4MVx1N0QyMFx1MzA5Mlx1NTNENlx1NUY5N1x1MzA1OVx1MzA4QlxyXG4gICAgICogQHBhcmFtIHF1ZXJ5IFx1MzBBRlx1MzBBOFx1MzBFQVxyXG4gICAgICovXHJcbiAgICBHZXQocXVlcnk6c3RyaW5nKTogQXR0ZW1wdFJlc3VsdFdpZHRoRGF0YTxFbGVtZW50PjtcclxuXHJcbiAgICAvKipcclxuICAgICAqIFx1ODkwN1x1NjU3MFx1MzA2RVx1ODk4MVx1N0QyMFx1MzA5Mlx1NTNENlx1NUY5N1x1MzA1OVx1MzA4QlxyXG4gICAgICogQHBhcmFtIHF1ZXJ5IFx1MzBBRlx1MzBBOFx1MzBFQVxyXG4gICAgICovXHJcbiAgICBHZXRBbGwocXVlcnk6IHN0cmluZyk6IEF0dGVtcHRSZXN1bHRXaWR0aERhdGE8Tm9kZUxpc3RPZjxFbGVtZW50Pj47XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBFbGVtZW50SGFuZGxlckltcGwgaW1wbGVtZW50cyBFbGVtZW50SGFuZGxlciB7XHJcblxyXG4gICAgcHVibGljIEdldChxdWVyeTogc3RyaW5nKTogQXR0ZW1wdFJlc3VsdFdpZHRoRGF0YTxFbGVtZW50PiB7XHJcblxyXG4gICAgICAgIGxldCByZXN1bHQ6IEVsZW1lbnQgfCBudWxsO1xyXG5cclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICByZXN1bHQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHF1ZXJ5KTtcclxuICAgICAgICB9IGNhdGNoIChlOiBhbnkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIEF0dGVtcHRSZXN1bHRXaWR0aERhdGFJbXBsLkZhaWwoYFx1ODk4MVx1N0QyMFx1MzA5Mlx1NTNENlx1NUY5N1x1MzA2N1x1MzA0RFx1MzA3RVx1MzA1Qlx1MzA5M1x1MzA2N1x1MzA1N1x1MzA1Rlx1MzAwMihcdThBNzNcdTdEMzBcdUZGMUEke2UubWVzc2FnZX0pYCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gcmVzdWx0ID09IG51bGwgPyBBdHRlbXB0UmVzdWx0V2lkdGhEYXRhSW1wbC5GYWlsKFwiXHU2MzA3XHU1QjlBXHUzMDU1XHUzMDhDXHUzMDVGXHU4OTgxXHU3RDIwXHUzMDRDXHU4OThCXHUzMDY0XHUzMDRCXHUzMDhBXHUzMDdFXHUzMDVCXHUzMDkzXHUzMDAyXCIpIDogQXR0ZW1wdFJlc3VsdFdpZHRoRGF0YUltcGwuU3VjY2VlZGVkKHJlc3VsdCk7XHJcbiAgICB9XHJcblxyXG5cclxuICAgIHB1YmxpYyBHZXRBbGwocXVlcnk6IHN0cmluZyk6IEF0dGVtcHRSZXN1bHRXaWR0aERhdGE8Tm9kZUxpc3RPZjxFbGVtZW50Pj4ge1xyXG5cclxuICAgICAgICBsZXQgcmVzdWx0OiBOb2RlTGlzdE9mPEVsZW1lbnQ+O1xyXG5cclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICByZXN1bHQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHF1ZXJ5KTtcclxuICAgICAgICB9IGNhdGNoIChlOiBhbnkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIEF0dGVtcHRSZXN1bHRXaWR0aERhdGFJbXBsLkZhaWwoYFx1ODk4MVx1N0QyMFx1MzA5Mlx1NTNENlx1NUY5N1x1MzA2N1x1MzA0RFx1MzA3RVx1MzA1Qlx1MzA5M1x1MzA2N1x1MzA1N1x1MzA1Rlx1MzAwMihcdThBNzNcdTdEMzBcdUZGMUEke2UubWVzc2FnZX0pYCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gQXR0ZW1wdFJlc3VsdFdpZHRoRGF0YUltcGwuU3VjY2VlZGVkKHJlc3VsdCk7XHJcbiAgICB9XHJcblxyXG59IiwgImV4cG9ydCBjbGFzcyBFbGVtZW50SURzIHtcclxuXHJcbiAgICBwdWJsaWMgc3RhdGljIHJlYWRvbmx5IFBhZ2VDb250ZW50ID0gJy5QYWdlQ29udGVudCc7XHJcblxyXG4gICAgcHVibGljIHN0YXRpYyByZWFkb25seSBWaWRlb0xpc3RIZWFkZXIgPSAnI1ZpZGVvTGlzdEhlYWRlcic7XHJcblxyXG4gICAgcHVibGljIHN0YXRpYyByZWFkb25seSBTZXBhcmF0b3IgPSAnLlNlcGFyYXRvcic7XHJcblxyXG59IiwgImltcG9ydCB7IEF0dGVtcHRSZXN1bHRXaWR0aERhdGEgfSBmcm9tICcuLi8uLi9zaGFyZWQvQXR0ZW1wdFJlc3VsdCc7XHJcbmltcG9ydCB7IEVsZW1lbnRIYW5kbGVyIH0gZnJvbSAnLi4vLi4vc2hhcmVkL0VsZW1lbnRIYW5kbGVyJztcclxuaW1wb3J0IHsgRWxlbWVudElEcyB9IGZyb20gJy4vRWxlbWVudElkcyc7XHJcbmltcG9ydCB7IERpY3Rpb25hcnkgfSBmcm9tICcuLi8uLi9zaGFyZWQvQ29sbGVjdGlvbi9kaWN0aW9uYXJ5JztcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgV2lkdGhIYW5kbGVyIHtcclxuICAgIEluaXRpYWxpemUoKTogdm9pZDtcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIFdpZHRoSGFuZGxlckltcGwgaW1wbGVtZW50cyBXaWR0aEhhbmRsZXIge1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKGVsZW1lbnRIYW5kbGVyOiBFbGVtZW50SGFuZGxlcikge1xyXG4gICAgICAgIHRoaXMuX2VsbUhhbmRsZXIgPSBlbGVtZW50SGFuZGxlcjtcclxuICAgICAgICB0aGlzLl9jb2x1bW5JRHMgPSB7XHJcbiAgICAgICAgICAgICcwJzogJ0NoZWNrQm94Q29sdW1uJyxcclxuICAgICAgICAgICAgJzEnOiAnVGh1bWJuYWlsQ29sdW1uJyxcclxuICAgICAgICAgICAgJzInOiAnVGl0bGVDb2x1bW4nLFxyXG4gICAgICAgICAgICAnMyc6ICdVcGxvYWRlZERhdGVUaW1lQ29sdW1uJyxcclxuICAgICAgICAgICAgJzQnOiAnSXNEb3dubG9hZGVkQ29sdW1uJyxcclxuICAgICAgICAgICAgJzUnOiAnVmlld0NvdW50Q29sdW1uJyxcclxuICAgICAgICAgICAgJzYnOiAnQ29tbWVudENvdW50Q29sdW1uJyxcclxuICAgICAgICAgICAgJzcnOiAnTXlsaXN0Q291bnRDb2x1bW4nLFxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5fc2VwYXJhdG9ySURzID0ge1xyXG4gICAgICAgICAgICAnMCc6ICcjQ2hlY2tCb3hDb2x1bW5TZXBhcmF0b3InLFxyXG4gICAgICAgICAgICAnMSc6ICcjVGh1bWJuYWlsQ29sdW1uU2VwYXJhdG9yJyxcclxuICAgICAgICAgICAgJzInOiAnI1RpdGxlQ29sdW1uU2VwYXJhdG9yJyxcclxuICAgICAgICAgICAgJzMnOiAnI1VwbG9hZGVkRGF0ZVRpbWVDb2x1bW5TZXBhcmF0b3InLFxyXG4gICAgICAgICAgICAnNCc6ICcjSXNEb3dubG9hZGVkQ29sdW1uU2VwYXJhdG9yJyxcclxuICAgICAgICAgICAgJzUnOiAnI1ZpZXdDb3VudENvbHVtblNlcGFyYXRvcicsXHJcbiAgICAgICAgICAgICc2JzogJyNDb21tZW50Q291bnRDb2x1bW5TZXBhcmF0b3InLFxyXG4gICAgICAgICAgICAnNyc6ICcjTXlsaXN0Q291bnRDb2x1bW5TZXBhcmF0b3InLFxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgLy8jcmVnaW9uICBmaWVsZFxyXG5cclxuICAgIHByaXZhdGUgcmVhZG9ubHkgX2VsbUhhbmRsZXI6IEVsZW1lbnRIYW5kbGVyO1xyXG5cclxuICAgIHByaXZhdGUgcmVhZG9ubHkgX2NvbHVtbklEczogRGljdGlvbmFyeTxzdHJpbmc+O1xyXG5cclxuICAgIHByaXZhdGUgcmVhZG9ubHkgX3NlcGFyYXRvcklEczogRGljdGlvbmFyeTxzdHJpbmc+O1xyXG5cclxuICAgIHByaXZhdGUgX2lzUmVzaXppbmcgPSBmYWxzZTtcclxuXHJcbiAgICBwcml2YXRlIF9yZXNpemluZ0luZGV4OiBudWxsIHwgc3RyaW5nO1xyXG5cclxuICAgIC8vI2VuZHJlZ2lvblxyXG5cclxuICAgIHB1YmxpYyBJbml0aWFsaXplKCk6IHZvaWQge1xyXG5cclxuICAgICAgICBjb25zdCBzZXBSZXN1bHQ6IEF0dGVtcHRSZXN1bHRXaWR0aERhdGE8Tm9kZUxpc3RPZjxFbGVtZW50Pj4gPSB0aGlzLl9lbG1IYW5kbGVyLkdldEFsbChFbGVtZW50SURzLlNlcGFyYXRvcik7XHJcbiAgICAgICAgaWYgKCFzZXBSZXN1bHQuSXNTdWNjZWVkZWQgfHwgc2VwUmVzdWx0LkRhdGEgPT09IG51bGwpIHJldHVybjtcclxuXHJcbiAgICAgICAgc2VwUmVzdWx0LkRhdGEuZm9yRWFjaChlbG0gPT4ge1xyXG4gICAgICAgICAgICBpZiAoIShlbG0gaW5zdGFuY2VvZiBIVE1MRWxlbWVudCkpIHJldHVybjtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGluZGV4UyA9IGVsbS5kYXRhc2V0LmluZGV4O1xyXG5cclxuICAgICAgICAgICAgaWYgKGluZGV4UyA9PSB1bmRlZmluZWQpIHJldHVybjtcclxuXHJcbiAgICAgICAgICAgIGVsbS5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCBfID0+IHRoaXMuT25Nb3VzZURvd24oaW5kZXhTKSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGNvbnN0IHBhZ2VSZXN1bHQgPSB0aGlzLl9lbG1IYW5kbGVyLkdldChFbGVtZW50SURzLlBhZ2VDb250ZW50KTtcclxuICAgICAgICBpZiAoIXBhZ2VSZXN1bHQuSXNTdWNjZWVkZWQgfHwgcGFnZVJlc3VsdC5EYXRhID09PSBudWxsIHx8ICEocGFnZVJlc3VsdC5EYXRhIGluc3RhbmNlb2YgSFRNTEVsZW1lbnQpKSByZXR1cm47XHJcbiAgICAgICAgcGFnZVJlc3VsdC5EYXRhLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCBfID0+IHRoaXMuT25Nb3VzZVVwKCkpO1xyXG5cclxuICAgICAgICBjb25zdCBoZWFkZXJSZXN1bHQgPSB0aGlzLl9lbG1IYW5kbGVyLkdldChFbGVtZW50SURzLlZpZGVvTGlzdEhlYWRlcik7XHJcbiAgICAgICAgaWYgKCFoZWFkZXJSZXN1bHQuSXNTdWNjZWVkZWQgfHwgaGVhZGVyUmVzdWx0LkRhdGEgPT09IG51bGwgfHwgIShoZWFkZXJSZXN1bHQuRGF0YSBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KSkgcmV0dXJuO1xyXG4gICAgICAgIGhlYWRlclJlc3VsdC5EYXRhLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIGUgPT4gdGhpcy5Pbk1vdXNlTW92ZShlKSk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIC8vI3JlZ2lvbiBwcml2YXRlXHJcblxyXG4gICAgcHJpdmF0ZSBPbk1vdXNlRG93bihpbmRleDogc3RyaW5nKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5faXNSZXNpemluZyA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5fcmVzaXppbmdJbmRleCA9IGluZGV4O1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgT25Nb3VzZVVwKCk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuX2lzUmVzaXppbmcgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLl9yZXNpemluZ0luZGV4ID0gbnVsbDtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIE9uTW91c2VNb3ZlKGU6IE1vdXNlRXZlbnQpOiB2b2lkIHtcclxuICAgICAgICBpZiAoIXRoaXMuX2lzUmVzaXppbmcgfHwgdGhpcy5fcmVzaXppbmdJbmRleCA9PT0gbnVsbCkgcmV0dXJuO1xyXG5cclxuICAgICAgICBjb25zdCBuZXh0SW5kZXggPSBOdW1iZXIodGhpcy5fcmVzaXppbmdJbmRleCkgKyAxO1xyXG5cclxuICAgICAgICBjb25zdCBoZWFkZXJSZXN1bHQgPSB0aGlzLl9lbG1IYW5kbGVyLkdldChgIyR7dGhpcy5fY29sdW1uSURzW3RoaXMuX3Jlc2l6aW5nSW5kZXhdfWApO1xyXG4gICAgICAgIGNvbnN0IG5leHRIZWFkZXJSZXN1bHQgPSB0aGlzLl9lbG1IYW5kbGVyLkdldChgIyR7dGhpcy5fY29sdW1uSURzW2Ake25leHRJbmRleH1gXX1gKTtcclxuICAgICAgICBjb25zdCBoZWFkZXJXcmFwcGVyUmVzdWx0ID0gdGhpcy5fZWxtSGFuZGxlci5HZXQoRWxlbWVudElEcy5WaWRlb0xpc3RIZWFkZXIpO1xyXG4gICAgICAgIGNvbnN0IGNvbHVtblJlc3VsdCA9IHRoaXMuX2VsbUhhbmRsZXIuR2V0QWxsKGAuJHt0aGlzLl9jb2x1bW5JRHNbdGhpcy5fcmVzaXppbmdJbmRleF19YCk7XHJcbiAgICAgICAgY29uc3QgbmV4dENvbHVtblJlc3VsdCA9IHRoaXMuX2VsbUhhbmRsZXIuR2V0QWxsKGAuJHt0aGlzLl9jb2x1bW5JRHNbYCR7bmV4dEluZGV4fWBdfWApO1xyXG4gICAgICAgIGNvbnN0IHNlcFJlc3VsdCA9IHRoaXMuX2VsbUhhbmRsZXIuR2V0KHRoaXMuX3NlcGFyYXRvcklEc1t0aGlzLl9yZXNpemluZ0luZGV4XSk7XHJcblxyXG4gICAgICAgIGlmICghaGVhZGVyUmVzdWx0LklzU3VjY2VlZGVkIHx8IGhlYWRlclJlc3VsdC5EYXRhID09PSBudWxsIHx8ICFjb2x1bW5SZXN1bHQuSXNTdWNjZWVkZWQgfHwgY29sdW1uUmVzdWx0LkRhdGEgPT09IG51bGwgfHwgIXNlcFJlc3VsdC5Jc1N1Y2NlZWRlZCB8fCBzZXBSZXN1bHQuRGF0YSA9PT0gbnVsbCB8fCAhaGVhZGVyV3JhcHBlclJlc3VsdC5Jc1N1Y2NlZWRlZCB8fCBoZWFkZXJXcmFwcGVyUmVzdWx0LkRhdGEgPT09IG51bGwgfHwgIW5leHRIZWFkZXJSZXN1bHQuSXNTdWNjZWVkZWQgfHwgbmV4dEhlYWRlclJlc3VsdC5EYXRhID09PSBudWxsIHx8ICFuZXh0Q29sdW1uUmVzdWx0LklzU3VjY2VlZGVkIHx8IG5leHRDb2x1bW5SZXN1bHQuRGF0YSA9PT0gbnVsbCkgcmV0dXJuO1xyXG5cclxuICAgICAgICBpZiAoIShoZWFkZXJSZXN1bHQuRGF0YSBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KSkgcmV0dXJuO1xyXG4gICAgICAgIGlmICghKG5leHRIZWFkZXJSZXN1bHQuRGF0YSBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KSkgcmV0dXJuO1xyXG5cclxuICAgICAgICBjb25zdCBoZWFkZXJSZWN0OiBET01SZWN0ID0gaGVhZGVyUmVzdWx0LkRhdGEuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcbiAgICAgICAgY29uc3QgaGVhZGVyV3JhcHBlclJlY3Q6IERPTVJlY3QgPSBoZWFkZXJXcmFwcGVyUmVzdWx0LkRhdGEuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcblxyXG5cclxuICAgICAgICBjb25zdCB3aWR0aCA9IGUuY2xpZW50WCAtIGhlYWRlclJlY3QubGVmdDtcclxuICAgICAgICBjb25zdCBkZWx0YVdpZHRoID0gd2lkdGggLSBoZWFkZXJSZXN1bHQuRGF0YS5vZmZzZXRXaWR0aDtcclxuICAgICAgICBjb25zdCBuZXh0V2lkdGggPSBuZXh0SGVhZGVyUmVzdWx0LkRhdGEub2Zmc2V0V2lkdGggLSBkZWx0YVdpZHRoO1xyXG5cclxuICAgICAgICBoZWFkZXJSZXN1bHQuRGF0YS5zdHlsZS53aWR0aCA9IGAke3dpZHRofXB4YDtcclxuICAgICAgICBuZXh0SGVhZGVyUmVzdWx0LkRhdGEuc3R5bGUud2lkdGggPSBgJHtuZXh0V2lkdGh9cHhgO1xyXG5cclxuICAgICAgICBjb2x1bW5SZXN1bHQuRGF0YS5mb3JFYWNoKGVsbSA9PiB7XHJcbiAgICAgICAgICAgIGlmICghKGVsbSBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KSkgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgZWxtLnN0eWxlLndpZHRoID0gYCR7d2lkdGh9cHhgO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBuZXh0Q29sdW1uUmVzdWx0LkRhdGEuZm9yRWFjaChlbG0gPT4ge1xyXG4gICAgICAgICAgICBpZiAoIShlbG0gaW5zdGFuY2VvZiBIVE1MRWxlbWVudCkpIHJldHVybjtcclxuXHJcbiAgICAgICAgICAgIGVsbS5zdHlsZS53aWR0aCA9IGAke25leHRXaWR0aH1weGA7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGlmICghKGhlYWRlcldyYXBwZXJSZXN1bHQuRGF0YSBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KSkgcmV0dXJuO1xyXG4gICAgICAgIGlmICghKHNlcFJlc3VsdC5EYXRhIGluc3RhbmNlb2YgSFRNTEVsZW1lbnQpKSByZXR1cm47XHJcblxyXG4gICAgICAgIGNvbnN0IGxlZnQgPSBoZWFkZXJSZWN0LmxlZnQgLSBoZWFkZXJXcmFwcGVyUmVjdC5sZWZ0ICsgd2lkdGggLSAxMDtcclxuICAgICAgICBzZXBSZXN1bHQuRGF0YS5zdHlsZS5sZWZ0ID0gYCR7bGVmdH1weGA7XHJcbiAgICB9XHJcblxyXG4gICAgLy8jZW5kcmVnaW9uXHJcbn1cclxuXHJcbmludGVyZmFjZSBDbGFzc05hbWVzRGljdCB7XHJcbiAgICBbaW5kZXg6IG51bWJlcl06IHN0cmluZztcclxufSIsICJpbXBvcnQgeyBFbGVtZW50SGFuZGxlciwgRWxlbWVudEhhbmRsZXJJbXBsIH0gZnJvbSBcIi4uL3NoYXJlZC9FbGVtZW50SGFuZGxlclwiO1xyXG5pbXBvcnQgeyBXaWR0aEhhbmRsZXIsIFdpZHRoSGFuZGxlckltcGwgfSBmcm9tIFwiLi93aWR0aEhhbmRsZXIvd2lkdGhIYW5kbGVyXCI7XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gbWFpbigpIHtcclxuICAgIGNvbnNvbGUubG9nKFwiSGVsbG8gV29ybGQhIVwiKTtcclxuXHJcbiAgICBjb25zdCBlbG1IYW5kbGVyOiBFbGVtZW50SGFuZGxlciA9IG5ldyBFbGVtZW50SGFuZGxlckltcGwoKTtcclxuICAgIGNvbnN0IHdpZHRoSGFuZGxlcjogV2lkdGhIYW5kbGVyID0gbmV3IFdpZHRoSGFuZGxlckltcGwoZWxtSGFuZGxlcik7XHJcblxyXG4gICAgd2lkdGhIYW5kbGVyLkluaXRpYWxpemUoKTtcclxuXHJcbn0iXSwKICAibWFwcGluZ3MiOiAiO0FBc0JPLElBQU0sNkJBQU4sTUFBeUU7QUFBQSxFQUU1RSxZQUFZLGFBQXNCLE1BQWdCLFNBQXdCO0FBQ3RFLFNBQUssY0FBYztBQUNuQixTQUFLLE9BQU87QUFDWixTQUFLLFVBQVU7QUFBQSxFQUNuQjtBQUFBLEVBUUEsT0FBYyxVQUFhLE1BQTJDO0FBQ2xFLFdBQU8sSUFBSSwyQkFBMkIsTUFBTSxNQUFNLElBQUk7QUFBQSxFQUMxRDtBQUFBLEVBRUEsT0FBYyxLQUFRLFNBQTRDO0FBQzlELFdBQU8sSUFBSSwyQkFBMkIsT0FBTyxNQUFNLE9BQU87QUFBQSxFQUM5RDtBQUNKOzs7QUMxQk8sSUFBTSxxQkFBTixNQUFtRDtBQUFBLEVBRS9DLElBQUksT0FBZ0Q7QUFFdkQsUUFBSTtBQUVKLFFBQUk7QUFDQSxlQUFTLFNBQVMsY0FBYyxLQUFLO0FBQUEsSUFDekMsU0FBUyxHQUFQO0FBQ0UsYUFBTywyQkFBMkIsS0FBSywwR0FBcUIsRUFBRSxVQUFVO0FBQUEsSUFDNUU7QUFFQSxXQUFPLFVBQVUsT0FBTywyQkFBMkIsS0FBSyxrR0FBa0IsSUFBSSwyQkFBMkIsVUFBVSxNQUFNO0FBQUEsRUFDN0g7QUFBQSxFQUdPLE9BQU8sT0FBNEQ7QUFFdEUsUUFBSTtBQUVKLFFBQUk7QUFDQSxlQUFTLFNBQVMsaUJBQWlCLEtBQUs7QUFBQSxJ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
